بناءً على ملف `Common.cs` الذي اعتمدناه، إليك القيم المسموحة والمضبوطة (Enums) التي يجب عليك كتابتها في جدول **`SYS_DATA_MAP`**.

تذكر أن الكود يستخدم `StringEnumConverter`، لذا يجب كتابة الكلمة الإنجليزية كما هي (حالة الأحرف ليست مشكلة تقنياً، لكن يفضل الالتزام بالمعيار).

---

### 1. عمود `SOURCE_TYPE` (نوع البحث)
يحدد **كيف** يبحث النظام عن المعلومة.

| القيمة (Value) | الوصف | ماذا تكتب في `SOURCE_EXPRESSION`؟ |
| :--- | :--- | :--- |
| **`Header`** | **بحث باسم العمود.**<br>الخيار الأكثر استخداماً لملفات الإكسل. | اكتب اسم العمود كما يظهر في الملف.<br>مثال: `"Unit Price"` |
| **`Index`** | **بحث برقم العمود.**<br>تستخدم للملفات التي ليس لها رأس (CSV) أو أسماؤها متغيرة جداً. | اكتب رقم العمود (بدءاً من 0).<br>مثال: `"0"` (للعمود A)، `"4"` (للعمود E). |
| **`Context`** | **من خصائص المصدر.**<br>لا يقرأ من ملف الإكسل، بل من الـ JSON الموجود في `SYS_DATA_SOURCES`. | اكتب اسم المفتاح في الـ JSON.<br>مثال: `"Currency"`, `"Region"`. |
| **`Constant`** | **قيمة ثابتة.**<br>يضع هذه القيمة لكل الصفوف. | اكتب القيمة التي تريدها.<br>مثال: `"مورد خارجي"`. |
| **`Formula`** | **معادلة.**<br>(ميزة متقدمة) لحساب قيمة أثناء السحب. | معادلة بسيطة.<br>مثال: `Col1 * Col2`. |

---

### 2. عمود `MATCH_MODE` (طريقة المطابقة)
يستخدم **فقط** عندما يكون `SOURCE_TYPE` = **`Header`**.
(في الحالات الأخرى `Index/Context`، يتم تجاهل هذا العمود).

| القيمة (Value) | الوصف | متى تستخدمها؟ |
| :--- | :--- | :--- |
| **`Exact`** | **تطابق تام.**<br>يجب أن يكون الاسم مطابقاً 100% (مع تجاهل حالة الأحرف). | عندما تكون واثقاً من اسم العمود.<br>مثال: `"Code"` يطابق `"code"`. |
| **`Contains`** | **يحتوي على.**<br>يكفي وجود الكلمة داخل العنوان. | عندما يكون هناك "شوائب" في العنوان.<br>مثال: `"Price"` ستجد `"Unit Price (EGP)"`. |
| **`StartsWith`** | **يبدأ بـ.**<br>يجب أن تكون الكلمة في أول العنوان. | عندما تتشابه الأعمدة.<br>مثال: `"Total"` ستجد `"Total Cost"` ولن تجد `"Sub Total"`. |
| **`Regex`** | **تعبير نمطي.**<br>للبحث المتقدم جداً. | عندما تكون الصيغة معقدة.<br>مثال: `^Unit.*Price$` |

---

### أمثلة عملية (Copy-Paste)

#### مثال 1: سحب السعر (مرن)
*   **SOURCE_TYPE:** `Header`
*   **MATCH_MODE:** `Contains`
*   **EXPRESSION:** `Price`

#### مثال 2: سحب العملة من إعدادات الملف (ذكي)
*   **SOURCE_TYPE:** `Context`
*   **MATCH_MODE:** `Exact` (لا يهم هنا)
*   **EXPRESSION:** `Currency`

#### مثال 3: سحب العمود الخامس (لأنه بدون اسم)
*   **SOURCE_TYPE:** `Index`
*   **MATCH_MODE:** `Exact` (لا يهم هنا)
*   **EXPRESSION:** `4`
