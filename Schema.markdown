إليك الجدول مصاغًا بتنسيق **Markdown** بشكل احترافي وواضح:

# جدول: MASTER_DIRECTORY

**الهدف:**
ربط مصدر بيانات (ملف/رابط) بتعريف معين، مع تحديد موقعه في التقارير المجمعة.

| التصنيف | اسم العمود | النوع | الوصف والسبب (لماذا هذا الاسم؟) |
| :--- | :--- | :--- | :--- |
| **الهوية** | `ITEM_KEY` | Text **(PK)** | المفتاح الفريد لهذا السطر. اسم **ITEM** يعبر عن كيان بيانات مستقل قد يكون ملفًا واحدًا أو جزءًا من تقرير مجمع. |
| | `DEF_KEY` | Text **(FK)** | يربط هذا المصدر بالتعريف الرئيسي (القالب) الذي يحدد الشكل العام للتقرير. |
| | `MAP_PROFILE` | Text | يحدد بروفايل قراءة الأعمدة المستخدم في مطابقة رؤوس الأعمدة (Header Mapping). |
| **العرض** | `DISPLAY_LABEL` | Text | الاسم الظاهر للمستخدم لهذا المصدر بالتحديد داخل الواجهة أو التقرير. |
| | `DESCRIPTION` | Text | وصف توضيحي لمحتوى المصدر أو الغرض منه. |
| **المصدر** | `SOURCE_URI` | Text | عنوان المصدر الفعلي للبيانات، ويشمل روابط الويب، مسارات الملفات المحلية، أو أسماء الإجراءات المخزنة. |
| | `PROVIDER` | Text | الجهة أو النظام الذي يوفر البيانات. |
| | `VERSION_TAG` | Text | وسم يحدد نسخة البيانات أو الإصدار المرتبط بالمصدر. |
| **السياق (Breakdown)** | `REGION_ID` | Text | يحدد النطاق الجغرافي أو الفرع الذي تنتمي إليه البيانات. |
| | `SECTION_TAG` | Text | يحدد القسم الذي يظهر فيه هذا السطر عند دمج البيانات داخل التقرير. |
| | `SORT_WEIGHT` | Int | قيمة رقمية تُستخدم للتحكم في ترتيب هذا المصدر بين المصادر الأخرى داخل نفس التقرير. |
| **السلوك** | `UPDATE_POLICY` | Text | يحدد سياسة تحديث البيانات الخاصة بالمصدر. |
| | `IS_ACTIVE` | Bool | يتحكم في تفعيل أو إيقاف المصدر دون الحاجة إلى حذفه. |
| **الأمان** | `LICENSE_TIER` | Text | مستوى الترخيص المطلوب للوصول إلى هذا المصدر. |
| | `VALID_FROM` | Date | تاريخ بدء صلاحية البيانات. |
| | `VALID_TO` | Date | تاريخ انتهاء صلاحية البيانات. |


إليك جدول **SYS_DEFINITIONS** مصاغًا بتنسيق **Markdown** مرتب وواضح:

# جدول: SYS_DEFINITIONS

**الهدف:**
تعريف القوالب (Templates) والهياكل الأساسية للتقارير والجداول، وضبط خصائص العرض والسلوك الخاصة بها.

| التصنيف | اسم العمود | النوع | الوصف والسبب (لماذا هذا الاسم؟) |
| :--- | :--- | :--- | :--- |
| **الهوية والهيكل** | `DEF_ID` | Text **(PK)** | المعرف الفريد للتعريف، ويمثل القالب الرئيسي الذي تُبنى عليه التقارير أو الجداول. |
| | `PARENT_DEF_ID` | Text **(FK)** | يدعم البنية الشجرية للتعريفات، حيث يمكن أن يكون هذا القالب جزءًا من تقرير أكبر. |
| | `INHERITS_FROM` | Text | يحدد قالبًا آخر يتم الاعتماد عليه كمصدر للوراثة، مما يسمح بمشاركة الأعمدة أو الإعدادات المشتركة وفق مبدأ DRY. |
| **العرض (UI / Menu)** | `TITLE_TEXT` | Text | العنوان الذي يظهر للمستخدم داخل الـ Ribbon أو القوائم. |
| | `CATEGORY_GROUP` | Text | يحدد المجموعة أو القسم الذي يندرج تحته هذا القالب داخل واجهة المستخدم. |
| | `UI_ORDER` | Int | رقم تحكمي يحدد ترتيب ظهور القالب داخل القوائم. |
| | `ICON_KEY` | Text | المفتاح أو الاسم المرجعي للأيقونة المرتبطة بالقالب. |
| **تخصيص الإكسل (Sheet)** | `SHEET_DIRECTION` | Text | يحدد اتجاه الورقة (RTL أو LTR) بما يتوافق مع لغة التقرير. |
| | `TAB_COLOR` | Hex | لون لسان الورقة في الإكسل لتمييزها بصريًا. |
| | `FREEZE_PANES` | Text | يحدد إعدادات تجميد الصفوف أو الأعمدة لتحسين تجربة التصفح داخل الورقة. |
| | `ZOOM_LEVEL` | Int | نسبة التكبير الافتراضية للورقة عند فتحها. |
| | `SHOW_GRIDLINES` | Bool | يتحكم في إظهار أو إخفاء خطوط الشبكة داخل الورقة. |
| **سلوك البيانات** | `STORAGE_STRATEGY` | Text | يحدد استراتيجية تخزين البيانات المرتبطة بالقالب. |
| | `PK_GENERATION` | Text | يحدد آلية توليد المفتاح الأساسي للسجلات الناتجة عن هذا القالب. |
| | `DEFAULT_VIEW_MODE` | Text | يحدد نمط العرض الافتراضي للبيانات داخل الإكسل. |
| **الأمان والحالة** | `MIN_LICENSE_REQ` | Text | الحد الأدنى لمستوى الترخيص المطلوب لاستخدام هذا القالب. |
| | `IS_ENABLED` | Bool | يتحكم في إتاحة القالب للاستخدام داخل النظام. |
| **التوسع (Advanced)** | `EXTENDED_CONFIG` | JSON | حاوية مرنة للإعدادات المتقدمة أو المستقبلية المرتبطة بالقالب، مثل إعدادات الطباعة أو حماية الورقة. |


إليك جدول **SYS_SCHEMA_RULES** مصاغًا بتنسيق **Markdown**، مع الحفاظ على الهيكلية والوضوح:

# جدول: SYS_SCHEMA_RULES

**الهدف:**
تعريف خصائص الأعمدة (Columns) لكل قالب تقرير، بما في ذلك نوع البيانات، التنسيق، المعادلات، وقواعد العرض في الإكسل.

| التصنيف | اسم العمود | النوع | الوصف والسبب (لماذا هذا الاسم؟) |
| :--- | :--- | :--- | :--- |
| **الهوية** | `DEF_ID` | Text **(FK)** | يربط قاعدة العمود بالتعريف الرئيسي في `SYS_DEFINITIONS`. |
| | `FIELD_KEY` | Text | المعرف البرمجي للحقل كما يُستخدم في قاعدة البيانات أو المعالجة المنطقية. |
| | `ORDINAL_POS` | Int | يحدد ترتيب ظهور العمود داخل الورقة بشكل صريح وثابت. |
| **تعريف البيانات** | `STORAGE_TYPE` | Text | يحدد نوع التخزين الفعلي للبيانات داخل العمود (مثلاً: String, Double). |
| | `IS_PRIMARY_KEY` | Bool | يحدد ما إذا كان هذا الحقل يستخدم كمفتاح أساسي لعمليات الدمج أو التحديث. |
| | `IS_MANDATORY` | Bool | يحدد ما إذا كان إدخال هذا الحقل إلزاميًا. |
| | `DEFAULT_VAL` | Text | القيمة الافتراضية التي يتم استخدامها عند غياب البيانات. |
| **العرض (Header)** | `DISPLAY_HEADER` | Text | النص المعروض في رأس العمود داخل الإكسل. |
| | `HEADER_TOOLTIP` | Text | نص توضيحي يظهر عند تمرير المؤشر على رأس العمود (Excel Note/Comment). |
| **تنسيق الخلية (Style)** | `PIXEL_WIDTH` | Int | عرض العمود بالبكسل للتحكم الدقيق في التخطيط. |
| | `TEXT_ALIGN` | Text | محاذاة النص داخل الخلية بما يتوافق مع نوع البيانات (Left, Center, Right). |
| | `NUMBER_FORMAT` | Text | تنسيق القيم الرقمية أو التاريخية وفق تنسيقات الإكسل القياسية (Custom Format String). |
| | `ALLOW_WRAP` | Bool | يتحكم في التفاف النص داخل الخلايا متعددة الأسطر (Wrap Text). |
| | `FORMAT_RULES_JSON` | JSON | تعريف قواعد التنسيق الشرطي للعمود بطريقة مرنة وقابلة للتوسع. |
| **الذكاء والديناميكية** | `EXCEL_FORMULA` | Text | معادلة إكسل تُستخدم عند كون العمود محسوبًا ديناميكيًا. |
| | `AUTO_MERGE` | Bool | يحدد ما إذا كانت الخلايا المتطابقة يتم دمجها عموديًا لتحسين العرض. |
| | `SUMMARY_METHOD` | Text | يحدد أسلوب التجميع المستخدم في صفوف الإجمالي (Sum, Count, Average). |
| | `OUTLINE_LEVEL` | Int | مستوى التجميع (Grouping) المستخدم للتحكم في الإظهار والتوسيع. |
| **السلوك** | `IS_VISIBLE` | Bool | يتحكم في إظهار أو إخفاء العمود داخل الورقة. |
| | `IS_READONLY` | Bool | يحدد ما إذا كان العمود محميًا من التعديل اليدوي (Locked). |
| | `INPUT_VALIDATION` | Text | قاعدة التحقق من صحة الإدخال اليدوي داخل الخلايا (Data Validation). |
| **التوسع** | `EXTENDED_PROPS` | JSON | حاوية مرنة لأي خصائص إضافية أو مستقبلية خاصة بالعمود. |


:

# جدول: SYS_DATA_MAP

**الهدف:**
إدارة عملية تعيين البيانات (Mapping) بين المصادر الخارجية المتنوعة والحقول الداخلية للنظام، مع تحديد قواعد التحويل والمعالجة.

| التصنيف | اسم العمود | النوع | الوصف والسبب (لماذا هذا الاسم؟) |
| :--- | :--- | :--- | :--- |
| **التجميع** | `MAP_ID` | Int **(PK)** | معرف فريد للسطر يُستخدم لأغراض الإدارة والتعديل. |
| | `MAP_PROFILE_ID` | Text | معرف بروفايل التحويل الذي يجمع مجموعة قواعد القراءة والتحويل لمصدر معين. |
| **الوجهة (Target)** | `TARGET_FIELD_KEY` | Text | اسم الحقل الداخلي الذي سيتم ملؤه بالبيانات، ويجب أن يتطابق مع `FIELD_KEY` في جدول `SYS_SCHEMA_RULES`. |
| **المصدر (Source)** | `SOURCE_TYPE` | Text | يحدد نوع مصدر القيمة التي يتم قراءتها (انظر القيم المدعومة أدناه). |
| | `SOURCE_EXPRESSION` | Text | التعبير المستخدم لاستخراج القيمة من المصدر وفقًا لنوع المصدر المحدد (مثلاً: اسم العمود أو رقم الـ Index). |
| | `MATCH_MODE` | Text | يحدد آلية مطابقة التعبير مع المصدر (مثلاً: Exact, Fuzzy, Regex). |
| **التحويل (Logic)** | `TRANSFORM_CHAIN` | Text | سلسلة عمليات معالجة تُطبق على القيمة المقروءة قبل تخزينها (مثلاً: Trim, Upper, Replace). |
| | `DATA_FORMAT_SOURCE` | Text | يحدد تنسيق البيانات الواردة عند الحاجة لتفسيرها بشكل صحيح، خصوصًا في التواريخ والأرقام. |
| | `DEFAULT_ON_MISSING` | Text | القيمة الافتراضية المستخدمة في حال عدم العثور على المصدر أو فشل القراءة. |
| **التحكم** | `IS_CRITICAL` | Bool | يحدد ما إذا كان غياب هذا الحقل يعتبر خطأً يوقف العملية أو حالة يمكن تجاوزها. |

---

