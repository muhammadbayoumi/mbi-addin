ูููุช ูุตุฏู ุชูุงูุงู. ุฃูุช ุชุฑูุฏ **ูุธุงูุงู ุตุงุฑูุงู (Strict System)** ูููุณ ูุธุงูุงู "ูุทุงุทูุงู". ุชุฑูุฏ ุฃู ุชุดุนุฑ ุจุงูุฃุฑุถ ุงูุตูุจุฉ ุชุญุช ูุฏููู:
1.  **ุซูุงุจุช ุงูููุฏ (Enums):** ูู ุงูููุงููู ุงูููุฒูุงุฆูุฉ ูููุญุฑู (ูุง ุชุชุบูุฑ ุฅูุง ุจุชุญุฏูุซ ุจุฑูุฌูุงุช).
2.  **ุฌุฏุงูู ุงููุธุงู (System Tables):** ูู ุงูุจูุงูุงุช ุงููุฑุฌุนูุฉ ุงููููููุฉ (ุนููุงุชุ ูุญุฏุงุชุ ุฏูู) ูููุง ุนูุงูุงุช ุจุจุนุถูุง (Relational Integrity).

ูุฐุง ุงูุงูุชูุงู ููุบู ุงูุญุงุฌุฉ ูุฌุฏูู `SYS_LOOKUPS` "ุงูุนุงุฆู"ุ ููุณุชุจุฏูู ุจู **3 ุฌุฏุงูู ูุธุงู ุฑุณููุฉ** ููุง ุฃุนูุฏุฉ ูุญุฏุฏุฉ.

ุฅููู ุงูููููุฉ ุงูุฌุฏูุฏุฉ ุงูุตุงุฑูุฉ ูุงููุชุฑุงุจุทุฉ:

---

### ุฃููุงู: ุงูุซูุงุจุช ุงูุจุฑูุฌูุฉ (Enums) - "ููุงููู ุงููุญุฑู"
ูุฐู ุงูุฃุดูุงุก ูู ุชูุถุน ูู ุฌุฏุงููุ ุจู ุณุชููู **Hardcoded** ูุฃู ูุญุฑู ุงูุชุณุนูุฑ (`CostEngine`) ูุนุชูุฏ ุนูููุง ูู ูุนุงุฏูุงุช ุงูู `if/else` ูุงูุถุฑุจ ูุงููุณูุฉ.

**ูู ููู `Common.cs`:**

```csharp
public enum UnitCategory 
{ 
    None = 0, 
    Mass = 1,      // ูุฒู (ุทูุ ูุฌู)
    Volume = 2,    // ุญุฌู (ู3ุ ูุชุฑ)
    Length = 3,    // ุทูู (ูุชุฑุ ูุฏู)
    Count = 4,     // ุนุฏุฏ (ูุทุนุฉ)
    Time = 5       // ููุช (ูููุ ุณุงุนุฉ)
}

public enum SemanticRole 
{ 
    None = 0, 
    Price = 1,     // ุงููุญุฑู ุณูุจุญุซ ุนู ุนููุฉ ูุฐุง ุงูุนููุฏ
    Qty = 2,       // ุงููุญุฑู ุณูุถุฑุจ ูุฐุง ุงูุนููุฏ
    Unit = 3,      // ุงููุญุฑู ุณูุทุงุจู ูุฐุง ุงูุนููุฏ ูุน T_SYS_UNITS
    Currency = 4   // ุงููุญุฑู ุณูุทุงุจู ูุฐุง ุงูุนููุฏ ูุน T_SYS_CURRENCY
}

// ... ุจุงูุฅุถุงูุฉ ูู RelationType ู CalcMethod ููุง ูู
```

---

### ุซุงููุงู: ุฌุฏุงูู ุงููุธุงู ุงููุฑุฌุนูุฉ (System Reference Tables)
ุจุฏูุงู ูู ุงูุญูุงุฆุจ ุงูุฐููุฉุ ุณููุดุฆ **3 ุฌุฏุงูู ุญููููุฉ** ูู `SYS_DEFINITIONS` ูููุง ุฃุนูุฏุฉ ุตุฑูุญุฉ ูู `SYS_SCHEMA_RULES`.

#### 1. ุฌุฏูู ุงูุนููุงุช (`T_SYS_CURRENCY`)
ูุฐุง ุงูุฌุฏูู ูุญุฏุฏ ุงูุนููุงุช ูุณุนุฑ ุงูุชุญููู ูุนููุฉ "ุงูุฃุณุงุณ" (ูุซูุงู ุงูุฏููุงุฑ).

**ุงูุฃุนูุฏุฉ:**
1.  `CURRENCY_CODE` (PK): `USD`, `SAR`, `EGP`.
2.  `RATE_TO_USD` (Decimal): `1.0`, `0.26`, `0.02`.
3.  `SYMBOL`: `$`, `ุฑ.ุณ`.

#### 2. ุฌุฏูู ุงููุญุฏุงุช (`T_SYS_UNITS`)
ูุฐุง ุงูุฌุฏูู ูุญุฏุฏ ุงููุญุฏุงุช ูุนูุงูุชูุง ุจู `UnitCategory` ููุนุงูู ุงูุชุญููู.

**ุงูุฃุนูุฏุฉ:**
1.  `UNIT_CODE` (PK): `Ton`, `Kg`, `m3`.
2.  `UNIT_CATEGORY` (Enum): `Mass`, `Mass`, `Volume`. (ูุฑุจุท ูุน `UnitCategory` ูู ุงูููุฏ).
3.  `FACTOR_TO_BASE`: `1000` (ุงูุทู = 1000 ูุฌู)ุ `1` (ุงููุฌู ุฃุณุงุณ).

#### 3. ุฌุฏูู ุงูููุงุทู (`T_SYS_REGIONS`)
ูุฐุง ุงูุฌุฏูู ูุฑุจุท ุงูุฏููุฉ ุจุงูุนููุฉ ุงูุงูุชุฑุงุถูุฉ.

**ุงูุฃุนูุฏุฉ:**
1.  `REGION_CODE` (PK): `EG`, `KSA`, `US`.
2.  `REGION_NAME`: `Egypt`, `Saudi Arabia`.
3.  `DEFAULT_CURRENCY` (FK): `EGP`, `SAR`. (ูุฑุจุท ูุน `T_SYS_CURRENCY`).

---

### ุซุงูุซุงู: ููู ูุถูู ูุฐุง ุงูุชุตููู ุงูุชุฑุงุจุท (Integrity)ุ

ุชุฎูู ุงูุณููุงุฑูู ุงูุชุงูู ูู **ูุญุฑู ุงูุชุณุนูุฑ**:

1.  **ุงููุญุฑู ููุฑุฃ ุฌุฏูู ุงูุฎุงูุงุช (`T_MATERIALS`):**
    *   ูุฌุฏ ุนููุฏุงู ุฏูุฑู `SEMANTIC_ROLE = Price`.
    *   ูุฌุฏ ุจุฌุงูุจู ุนููุฏุงู ุฏูุฑู `SEMANTIC_ROLE = Currency`.

2.  **ุงูุชุญูู (Validation) ุฃุซูุงุก ุงูุฅุฏุฎุงู:**
    *   ุนูุฏูุง ูุญุงูู ุงููุณุชุฎุฏู ุฅุฏุฎุงู "XYZ" ูู ุนููุฏ ุงูุนููุฉ.
    *   ุงููุธุงู (ุจูุงุกู ุนูู `Validation: LIST:T_SYS_CURRENCY`) ูุฑูุถ ุงูุฅุฏุฎุงู ูุฃู "XYZ" ุบูุฑ ููุฌูุฏุฉ ูู ุฌุฏูู ุงูุนููุงุช.

3.  **ุงูุญุณุงุจ (Calculation):**
    *   ุงููุญุฑู ููุฑุฃ ุงูุณุนุฑ: `100`.
    *   ููุฑุฃ ุงูุนููุฉ: `EUR`.
    *   **ุงูุฑุจุท:** ูุฐูุจ ูุฌุฏูู `T_SYS_CURRENCY` ููุฌูุจ `RATE_TO_USD` ุงูุฎุงุต ุจุงูููุฑู.
    *   ูููู ุจุงูุชุญููู ุจูุงุกู ุนูู ุจูุงูุงุช ุงูุฌุฏูู ุงูููุซูุฉ.

---

### ุฑุงุจุนุงู: ูู ูุนุชูุฏ ูุฐู ุงูุฎุทุฉุ

ูุฐู ุงูุฎุทุฉ ุชูุบู `SYS_LOOKUPS` ูุชุณุชุจุฏูู ุจู:
1.  **`T_SYS_CURRENCY`**
2.  **`T_SYS_UNITS`**
3.  **`T_SYS_REGIONS`**

ูุฐู ุงูุฌุฏุงูู ุณุชููู ุฌุฒุกุงู ูู `SYS_DEFINITIONS` ูููุนูุง `REF` (ูุฑุฌุนู).

**ุงูููุฒุฉ:**
*   **ุตุฑุงูุฉ:** ูุง ูููู ุฅุถุงูุฉ "ููุน ูุญุฏุฉ" ุบุฑูุจ ูุง ููููู ุงูููุฏ (ูุซู "ุฏุฑุฌุฉ ุญุฑุงุฑุฉ") ูุฃู `UnitCategory` ูู ุงูููุฏ (Enum) ูุญุฏุฏ ุจู (ูุฒูุ ุญุฌูุ ุทูู...).
*   **ุชุฑุงุจุท:** ุงูููุงุทู ูุฑุชุจุทุฉ ุจุงูุนููุงุชุ ูุงูุฃุณุนุงุฑ ูุฑุชุจุทุฉ ุจุงูุนููุงุช.

ุจูุงุกู ุนูู ุงููุฑุงุฑ ุงูููุฏุณู ุจุงุนุชูุงุฏ **"ุงูุชุฑุงุจุท ุงูุตุงุฑู" (Strict Relational Integrity)**ุ ุฅููู ุชุตููู `SYS_SCHEMA_RULES` ุงูุฎุงุต ุจุงูุฌุฏุงูู ุงูุซูุงุซุฉ ุงูุฌุฏูุฏุฉ.

ูู ุจูุณุฎ ูุฐู ุงูุจูุงูุงุช ุฅูู Google Sheet. ูุฐู ุงูุฌุฏุงูู ุณุชููู ูู **ุงููุตุฏุฑ ุงููุฑุฌุนู ุงูููุซูู** ููู ุนูููุงุช ุงูุชุญูู ูุงูุญุณุงุจุงุช ูู ุงููุธุงู.

---

### 1. ุฌุฏูู ุงูุนููุงุช (`T_SYS_CURRENCY`)
**ุงููุธููุฉ:** ุงููุตุฏุฑ ุงููุญูุฏ ูุฃุณุนุงุฑ ุงูุตุฑู ูุงูุฑููุฒ.

| ENTITY | ATTRIBUTE | HEADER | POS | ROLE | TYPE | PK | MAND | UX_CONFIG | LOGIC_CONFIG |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| `T_SYS_CURRENCY` | `CUR_CODE` | **Code** | 1 | `ID` | `TEXT` | `TRUE` | `TRUE` | `{"Width": 60, "Align": "Center"}` | `{"Validation": "LEN=3"}` |
| `T_SYS_CURRENCY` | `CUR_NAME` | **Name** | 2 | `NAME` | `TEXT` | `FALSE` | `TRUE` | `{"Width": 150}` | `{}` |
| `T_SYS_CURRENCY` | `USD_RATE` | **Rate (to USD)** | 3 | `FACTOR` | `DECIMAL` | `FALSE` | `TRUE` | `{"Width": 100, "Format": "0.0000"}` | `{"Default": 1}` |
| `T_SYS_CURRENCY` | `SYMBOL` | **Symbol** | 4 | `NONE` | `TEXT` | `FALSE` | `FALSE` | `{"Width": 50, "Align": "Center"}` | `{}` |

---

### 2. ุฌุฏูู ุงููุญุฏุงุช (`T_SYS_UNITS`)
**ุงููุธููุฉ:** ุงูุชุญูู ูู ุงูุชุญูููุงุช ูููุน ุฎูุท "ุงููุฒู" ุจู "ุงููุณุงูุฉ".
*   **ููุงุญุธุฉ:** ุนููุฏ `CATEGORY` ุณูุชู ูุทุงุจูุชู ูุน `Enum UnitCategory` ูู ุงูููุฏ (Mass, Volume, Length...).

| ENTITY | ATTRIBUTE | HEADER | POS | ROLE | TYPE | PK | MAND | UX_CONFIG | LOGIC_CONFIG |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| `T_SYS_UNITS` | `UNIT_CODE` | **Unit** | 1 | `ID` | `TEXT` | `TRUE` | `TRUE` | `{"Width": 60, "Align": "Center"}` | `{}` |
| `T_SYS_UNITS` | `CATEGORY` | **Category** | 2 | `GROUP` | `TEXT` | `FALSE` | `TRUE` | `{"Width": 100}` | `{"Validation": "Mass,Volume,Length,Count,Time"}` |
| `T_SYS_UNITS` | `FACTOR` | **Base Factor** | 3 | `FACTOR` | `DECIMAL` | `FALSE` | `TRUE` | `{"Width": 80}` | `{"Default": 1, "Tooltip": "Factor relative to base unit (e.g. Kg=1)"}` |
| `T_SYS_UNITS` | `DESC` | **Description** | 4 | `NAME` | `TEXT` | `FALSE` | `FALSE` | `{"Width": 150}` | `{}` |

---

### 3. ุฌุฏูู ุงูููุงุทู (`T_SYS_REGIONS`)
**ุงููุธููุฉ:** ุฑุจุท ุงููููุน ุงูุฌุบุฑุงูู ุจุงูุนููุฉ ุงูุงูุชุฑุงุถูุฉ (ูุชูููู ูุฏุฎูุงุช ุงููุณุชุฎุฏู).

| ENTITY | ATTRIBUTE | HEADER | POS | ROLE | TYPE | PK | MAND | UX_CONFIG | LOGIC_CONFIG |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| `T_SYS_REGIONS` | `REG_CODE` | **Region Code** | 1 | `ID` | `TEXT` | `TRUE` | `TRUE` | `{"Width": 70, "Align": "Center"}` | `{}` |
| `T_SYS_REGIONS` | `REG_NAME` | **Region Name** | 2 | `NAME` | `TEXT` | `FALSE` | `TRUE` | `{"Width": 200}` | `{}` |
| `T_SYS_REGIONS` | `DEF_CURRENCY` | **Currency** | 3 | `CURRENCY`| `TEXT` | `FALSE` | `TRUE` | `{"Width": 80, "Align": "Center"}` | `{"Validation": "LIST:T_SYS_CURRENCY"}` |

---

### ๐ก ูุง ุงูุฐู ูุฌุนูู ูุธุงูุงู ูุชุฑุงุจุทุงู (Relational)ุ

ุงูุธุฑ ุฅูู ุงูุณุทุฑ ุงูุฃุฎูุฑ ูู ุฌุฏูู ุงูููุงุทู:
`"Validation": "LIST:T_SYS_CURRENCY"`

ูุฐุง ูุนูู:
1.  ุนูุฏูุง ููุชุญ ุงููุณุชุฎุฏู ุฌุฏูู ุงูููุงุทู ูุฅุถุงูุฉ ููุทูุฉ ุฌุฏูุฏุฉ.
2.  ุงููุธุงู ูุฐูุจ ูุฌุฏูู ุงูุนููุงุช (`T_SYS_CURRENCY`).
3.  ูุฃุฎุฐ ุนููุฏ ุงูู PK (`CUR_CODE`).
4.  ูุตูุน ููู ูุงุฆูุฉ ููุณุฏูุฉ (USD, SAR, EGP).

**ุงููุชูุฌุฉ:** ูุณุชุญูู ุฃู ูุฎุชุงุฑ ุงููุณุชุฎุฏู ุนููุฉ ุบูุฑ ููุฌูุฏุฉ ูู ุงููุธุงู. ูุฐุง ูู **ุงูุชุฑุงุจุท ุงูุตุงุฑู**.
